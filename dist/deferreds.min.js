!function(a){function b(){this.onDone=[],this.onFail=[]}function c(b,c){this.finalized||(this.finalized=!0,this["resolve"===b?"doneWith":"failedWith"]=c,a.each(this["resolve"===b?"onDone":"onFail"],function(a,b){b.apply(this,c)}))}b.prototype={done:function(a){return this.doneWith?a.apply(this,this.doneWith):this.onDone.push(a),this},fail:function(a){return this.failedWith?a.apply(this,this.failedWith):this.onFail.push(a),this},resolve:function(){c.call(this,"resolve",a.slice(arguments))},reject:function(){c.call(this,"reject",a.slice(arguments))}},a.extend(a,{Deferred:function(a){return new b},when:function(){var c=a.slice(arguments),d=a.Deferred(),e=function(){var e=[];a.each(c,function(a,c){c instanceof b?c.doneWith&&e.push(1==c.doneWith.length?c.doneWith[0]:c.doneWith):e.push(c)}),e.length===c.length&&d.resolve(e)};return a.each(c,function(a,c){c instanceof b&&c.done(e)}),d}})}(window.simpleQuery);